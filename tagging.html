<!DOCTYPE html>
<html lang="en">
<head prefix="og: http://ogp.me/ns#">
  <meta charset="utf-8">
  <title>Tagging | Laragon - portable, isolated, fast & powerful universal development environment for PHP, Node.js, Python, Java, Go, Ruby.</title>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="keywords" content="microservices, nodejs, javascript">
	<meta name="robots" content="index, follow">
  <!-- Canonical links -->
  <link rel="canonical" href="">
  <!-- Alternative links -->
  
    
      <link rel="alternative" hreflang="en" href="">
    
  
  <!-- Icon -->
  <link rel="apple-touch-icon" sizes="57x57" href="https://laragon.org/icon/apple-touch-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="114x114" href="https://laragon.org/icon/apple-touch-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="72x72" href="https://laragon.org/icon/apple-touch-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="144x144" href="https://laragon.org/icon/apple-touch-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="60x60" href="https://laragon.org/icon/apple-touch-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="120x120" href="https://laragon.org/icon/apple-touch-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="76x76" href="https://laragon.org/icon/apple-touch-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="152x152" href="https://laragon.org/icon/apple-touch-icon-152x152.png">
  <link rel="icon" type="image/png" href="https://laragon.org/icon/favicon-96x96.png" sizes="96x96">
  <link rel="icon" type="image/png" href="https://laragon.org/icon/favicon-16x16.png" sizes="16x16">
  <link rel="icon" type="image/png" href="https://laragon.org/icon/favicon-32x32.png" sizes="32x32">
  <meta name="msapplication-TileColor" content="#2f83cd">
  <meta name="msapplication-TileImage" content="/icon/mstile-144x144.png">
  <!-- CSS -->
  <!-- build:css build/css/moleculer.css -->
  
<link rel="stylesheet" href="static/css/moleculer.css">

  <!-- endbuild -->
  <link href="static/css/css.css" rel="stylesheet" type="text/css">
  <link rel="stylesheet" href="static/css/font-awesome.min.css">
  <link rel="stylesheet" href="static/css/docsearch.min.css">
  <!-- RSS 
  <link rel="alternate" href="/atom.xml" title="Laragon - portable, isolated, fast & powerful universal development environment for PHP, Node.js, Python, Java, Go, Ruby.">
  -->
  <!-- Open Graph -->
  <meta name="description" content="In this iteration we‚Äôll add the ability to tag articles for organization and navigation. First we need to think about what a tag is and how it‚Äôll relate to the Article model. If you‚Äôre not familiar wi">
<meta property="og:type" content="website">
<meta property="og:title" content="Tagging">
<meta property="og:url" content="https://laragon.org/rails/tagging">
<meta property="og:site_name" content="Laragon - portable, isolated, fast &amp; powerful universal development environment for PHP, Node.js, Python, Java, Go, Ruby.">
<meta property="og:description" content="In this iteration we‚Äôll add the ability to tag articles for organization and navigation. First we need to think about what a tag is and how it‚Äôll relate to the Article model. If you‚Äôre not familiar wi">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2019-03-01T09:46:09.444Z">
<meta property="article:modified_time" content="2019-03-01T09:46:09.444Z">
<meta property="article:author" content="leokhoa">
<meta name="twitter:card" content="summary">
<meta name="twitter:site" content="leovn">
  <!-- Google Analytics -->
  
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-617943-3', 'auto');
  ga('send', 'pageview');
</script>

  <!-- Github Button -->
  <script async="" defer="" src="static/js/buttons.js"></script>
</head>

<body>
  <div id="particles-js"></div>
  <header id="header" class="wrapper">
  <div id="header-inner" class="inner">
    <h1 id="logo-wrap">
      <a href="index.html" id="logo">Laragon</a>
    </h1>
    <nav id="main-nav">
      <a href="index1.html" class="main-nav-link">Docs</a>
	<!--
      <a href="https://github.com/leokhoa/laragon" target="_blank" rel="noopener" class="main-nav-link">Github</a>
      <div id="search-input-wrap" class="on">
        <div id="search-input-icon">
          <i class="fa fa-search"></i>
        </div>
        <input type="search" id="search-input" placeholder="Search...">
      </div>
	-->
	 <a href="index2.html" class="main-nav-link">Why Laragon?</a>
    <a href="index3.html" class="main-nav-link">Testimonials</a>
    <a href="index4.html" class="main-nav-link">Download</a>
    <a href="index5.html" class="main-nav-link">About</a>
    <a href="index6.html" target="_blank" rel="noopener" class="main-nav-link">Community</a>
    
   
    


    </nav>
    <div id="lang-select-wrap">
      <label id="lang-select-label"><i class="fa fa-globe"></i><span>English</span></label>
      <select id="lang-select" data-canonical="">
        
          <option value="en" selected="">English</option>
        
      </select>
    </div>
    <a id="mobile-nav-toggle">
      <span class="mobile-nav-toggle-bar"></span>
      <span class="mobile-nav-toggle-bar"></span>
      <span class="mobile-nav-toggle-bar"></span>
    </a>
  </div>
</header>

  <div id="container">
    <div id="content-wrap">
  <div id="content" class="wrapper">
    <div id="content-inner">
      <article class="article-container" itemscope="" itemtype="http://schema.org/Article">
        <div class="article-inner">
          <div class="article">
            <div class="inner">
              <header class="article-header">
                <h1 class="article-title" itemprop="name">Tagging</h1>
                <a href="javascript:;" target="_blank" rel="noopener" class="article-edit-link" title="Improve this doc"><i class="fa fa-pencil"></i></a>
              </header>
              <div class="article-content" itemprop="articleBody">
                <p>In this iteration we‚Äôll add the ability to tag articles for organization and navigation.</p>
<p>First we need to think about what a tag is and how it‚Äôll relate to the Article model. If you‚Äôre not familiar with tags, they‚Äôre commonly used in blogs to assign the article to one or more categories.</p>
<p>For instance, if I write an article about a feature in Ruby on Rails, I might want it tagged with all of these categories: ‚Äúruby‚Äù, ‚Äúrails‚Äù and ‚Äúprogramming‚Äù. That way if one of my readers is looking for more articles about one of those topics they can click on the tag and see a list of my articles with that tag.</p>
<h3 id="Understanding-the-Relationship" class="article-heading"><a href="#Understanding-the-Relationship" class="headerlink" title="Understanding the Relationship"></a>Understanding the Relationship<a class="article-anchor" href="#Understanding-the-Relationship" aria-hidden="true"></a></h3><p>What is a tag?  We need to figure that out before we can create the model. First, a tag must have a relationship to an article so they can be connected. A single tag, like ‚Äúruby‚Äù for instance, should be able to relate to <em>many</em> articles. On the other side of the relationship, the article might have multiple tags (like ‚Äúruby‚Äù, ‚Äúrails‚Äù, and ‚Äúprogramming‚Äù as above) - so it‚Äôs also a <em>many</em> relationship. Articles and tags have a <em>many-to-many</em> relationship.</p>
<p>Many-to-many relationships are tricky because we‚Äôre using an SQL database. If an Article ‚Äúhas many‚Äù tags, then we would put the foreign key <code>article_id</code> inside the <code>tags</code> table - so then a Tag would ‚Äúbelong to‚Äù an Article. But a tag can connect to <em>many</em> articles, not just one. We can‚Äôt model this relationship with just the <code>articles</code> and <code>tags</code> tables.</p>
<p>When we start thinking about the database modeling, there are a few ways to achieve this setup. One way is to create a ‚Äújoin table‚Äù that just tracks which tags are connected to which articles. Traditionally this table would be named <code>articles_tags</code> and Rails would express the relationships by saying that the Article model <code>has_and_belongs_to_many</code> Tags, while the Tag model <code>has_and_belongs_to_many</code> Articles.</p>
<p>Most of the time this isn‚Äôt the best way to really model the relationship. The connection between the two models usually has value of its own, so we should promote it to a real model. For our purposes, we‚Äôll introduce a model named ‚ÄúTagging‚Äù which is the connection between Articles and Tags. The relationships will setup like this:</p>
<ul>
<li>An Article <code>has_many</code> Taggings</li>
<li>A Tag <code>has_many</code> Taggings</li>
<li>A Tagging <code>belongs_to</code> an Article and <code>belongs_to</code> a Tag</li>
</ul>
<h3 id="Making-Models" class="article-heading"><a href="#Making-Models" class="headerlink" title="Making Models"></a>Making Models<a class="article-anchor" href="#Making-Models" aria-hidden="true"></a></h3><p>With those relationships in mind, let‚Äôs design the new models:</p>
<ul>
<li>Tag<ul>
<li><code>name</code>: A string</li>
</ul>
</li>
<li>Tagging<ul>
<li><code>tag_id</code>: Integer holding the foreign key of the referenced Tag</li>
<li><code>article_id</code>: Integer holding the foreign key of the referenced Article</li>
</ul>
</li>
</ul>
<p>Note that there are no changes necessary to Article because the foreign key is stored in the Tagging model. So now lets generate these models in your terminal:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">rails generate model Tag name:string</span><br><span class="line">rails generate model Tagging tag:references article:references</span><br><span class="line">rake db:migrate</span><br></pre></td></tr></table></figure>
<h3 id="Expressing-Relationships" class="article-heading"><a href="#Expressing-Relationships" class="headerlink" title="Expressing Relationships"></a>Expressing Relationships<a class="article-anchor" href="#Expressing-Relationships" aria-hidden="true"></a></h3><p>Now that our model files are generated we need to tell Rails about the relationships between them. For each of the files below, add these lines:</p>
<p>In <code>app/models/article.rb</code>:</p>
<figure class="highlight ruby"><table><tr><td class="code"><pre><span class="line">has_many <span class="symbol">:taggings</span></span><br></pre></td></tr></table></figure>
<p>In <code>app/models/tag.rb</code>:</p>
<figure class="highlight ruby"><table><tr><td class="code"><pre><span class="line">has_many <span class="symbol">:taggings</span></span><br></pre></td></tr></table></figure>
<p>In <code>app/models/tagging.rb</code>:</p>
<figure class="highlight ruby"><table><tr><td class="code"><pre><span class="line">belongs_to <span class="symbol">:tag</span></span><br><span class="line">belongs_to <span class="symbol">:article</span></span><br></pre></td></tr></table></figure>
<p>After Rails had been around for awhile, developers were finding this kind of relationship very common. In practical usage, if I had an object named <code>article</code> and I wanted to find its Tags, I‚Äôd have to run code like this:</p>
<figure class="highlight ruby"><table><tr><td class="code"><pre><span class="line">tags = article.taggings.collect&#123;<span class="params">|tagging|</span> tagging.tag&#125;</span><br></pre></td></tr></table></figure>
<p>That‚Äôs a pain for something that we need commonly.</p>
<p>An article has a list of tags through the relationship of taggings. In Rails we can express this ‚Äúhas many‚Äù relationship through an existing ‚Äúhas many‚Äù relationship. We will update our article model and tag model to express that relationship.</p>
<p>In <code>app/models/article.rb</code>:</p>
<figure class="highlight ruby"><table><tr><td class="code"><pre><span class="line">has_many <span class="symbol">:taggings</span></span><br><span class="line">has_many <span class="symbol">:tags</span>, <span class="symbol">through:</span> <span class="symbol">:taggings</span></span><br></pre></td></tr></table></figure>
<p>In <code>app/models/tag.rb</code>:</p>
<figure class="highlight ruby"><table><tr><td class="code"><pre><span class="line">has_many <span class="symbol">:taggings</span></span><br><span class="line">has_many <span class="symbol">:articles</span>, <span class="symbol">through:</span> <span class="symbol">:taggings</span></span><br></pre></td></tr></table></figure>
<p>Now if we have an object like <code>article</code> we can just ask for <code>article.tags</code> or, conversely, if we have an object named <code>tag</code> we can ask for <code>tag.articles</code>.</p>
<p>To see this in action, start the <code>rails console</code> and try the following:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">article = Article.first</span><br><span class="line">article.tags.create name: &quot;tag1&quot;</span><br><span class="line">article.tags.create name: &quot;tag2&quot;</span><br><span class="line">article.tags</span><br><span class="line"></span><br><span class="line">=&gt; #&lt;ActiveRecord::Associations::CollectionProxy [#&lt;Tag id: 1, name: &quot;tag1&quot;, created_at: &quot;2017-06-29 11:51:09&quot;, updated_at: &quot;2017-06-29 11:51:09&quot;&gt;, #&lt;Tag id: 2, name: &quot;tag2&quot;, created_at: &quot;2017-06-29 11:51:30&quot;, updated_at: &quot;2017-06-29 11:51:30&quot;&gt;]&gt;</span><br></pre></td></tr></table></figure>
<h3 id="An-Interface-for-Tagging-Articles" class="article-heading"><a href="#An-Interface-for-Tagging-Articles" class="headerlink" title="An Interface for Tagging Articles"></a>An Interface for Tagging Articles<a class="article-anchor" href="#An-Interface-for-Tagging-Articles" aria-hidden="true"></a></h3><p>The first interface we‚Äôre interested in is within the article itself. When I write an article, I want to have a text box where I can enter a list of zero or more tags separated by commas. When I save the article, my app should associate my article with the tags with those names, creating them if necessary.</p>
<p>Add the following to our existing form in <code>app/views/articles/_form.html.erb</code> (below the input title):</p>
<figure class="highlight erb"><table><tr><td class="code"><pre><span class="line">&lt;p&gt;</span><br><span class="line">  &lt;%=<span class="ruby"> f.label <span class="symbol">:tag_list</span> </span>%&gt;&lt;br /&gt;</span><br><span class="line">  &lt;%=<span class="ruby"> f.text_field <span class="symbol">:tag_list</span> </span>%&gt;</span><br><span class="line">&lt;/p&gt;</span><br></pre></td></tr></table></figure>
<p>With that added, try to create a new article in your browser and you should see this error:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">NoMethodError in Articles#new</span><br><span class="line">Showing C:/laragon/www/blog/app/views/articles/_form.html.erb where line #14 raised:</span><br><span class="line"></span><br><span class="line">undefined method `tag_list&apos; for #&lt;Article:0x0000000cd05be0&gt;</span><br><span class="line">Did you mean?  tag_ids</span><br></pre></td></tr></table></figure>
<p>An Article doesn‚Äôt have an attribute or method named <code>tag_list</code>. We made it up in order for the form to display related tags, but we need to add a method to the <code>app/models/article.rb</code> file like this:</p>
<figure class="highlight ruby"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">tag_list</span></span></span><br><span class="line">  tags.join(<span class="string">", "</span>)</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<p>Back in your console, find that article again, and take a look at the results of <code>tag_list</code>:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">reload!</span><br><span class="line">article = Article.first</span><br><span class="line">article.tag_list</span><br><span class="line">=&gt; &quot;#&lt;Tag:0x000000075b6830&gt;, #&lt;Tag:0x000000075b6538&gt;&quot;</span><br></pre></td></tr></table></figure>
<p>That is not quite right. What happened?</p>
<p>Our array of tags is an array of Tag instances. When we joined the array Ruby called the default <code>#to_s</code> method on every one of these Tag instances. The default <code>#to_s</code> method for an object produces some really ugly output.</p>
<p>We could fix the <code>tag_list</code> method by:</p>
<ul>
<li>Converting all our tag objects to an array of tag names</li>
<li>Joining the array of tag names together</li>
</ul>
<figure class="highlight ruby"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">tag_list</span></span></span><br><span class="line">  <span class="keyword">self</span>.tags.collect <span class="keyword">do</span> <span class="params">|tag|</span></span><br><span class="line">    tag.name</span><br><span class="line">  <span class="keyword">end</span>.join(<span class="string">", "</span>)</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<p>Another alternative is to define a new <code>Tag#to_s</code> method which overrides the default:</p>
<figure class="highlight ruby"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Tag</span> &lt; ActiveRecord::Base</span></span><br><span class="line"></span><br><span class="line">  has_many <span class="symbol">:taggings</span></span><br><span class="line">  has_many <span class="symbol">:articles</span>, <span class="symbol">through:</span> <span class="symbol">:taggings</span></span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">to_s</span></span></span><br><span class="line">    name</span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<p>Now, when we try to join our <code>tags</code>, it‚Äôll delegate properly to our name<br>attribute. This is because <code>#join</code> calls <code>#to_s</code> on every element of the<br>array.</p>
<p>Your form should now show up and there‚Äôs a text box at the bottom named ‚ÄúTag list‚Äù.<br>Enter content for another sample article and in the tag list enter ‚Äòruby, technology‚Äô.<br>Click save. It‚Ä¶. worked? Oh, Yeah!</p>
<p>But it didn‚Äôt. Click ‚Äòedit‚Äô again, and you‚Äôll see that we‚Äôre back to the <code>#&lt;Tag...</code> business, like before. What gives?<br>Check the output on the console:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Started PATCH &quot;/articles/9&quot; for 127.0.0.1 at 2017-07-03 07:01:12 +0000</span><br><span class="line">Processing by ArticlesController#update as HTML</span><br><span class="line">  Parameters: &#123;&quot;utf8&quot;=&gt;&quot;‚úì&quot;, &quot;authenticity_token&quot;=&gt;&quot;HEpfzDlPK5ZSQHCfwBR23myLABivXACF8t31ZdgxlBRVrP/Wx03C4V51SU4LMYdLbB25Ngs36yCvsfx4PcWNJg==&quot;, &quot;article&quot;=&gt;&#123;&quot;title&quot;=&gt;&quot;Test Tagging&quot;, &quot;tag_list&quot;=&gt;&quot;ruby, technology&quot;, &quot;body&quot;=&gt;&quot;Here is some text&quot;&#125;, &quot;commit&quot;=&gt;&quot;Update Article&quot;, &quot;id&quot;=&gt;&quot;9&quot;&#125;</span><br><span class="line">  Article Load (0.0ms)  SELECT  &quot;articles&quot;.* FROM &quot;articles&quot; WHERE &quot;articles&quot;.&quot;id&quot; = ? LIMIT ?  [[&quot;id&quot;, 9], [&quot;LIMIT&quot;, 1]]</span><br><span class="line">Unpermitted parameter: :tag_list</span><br></pre></td></tr></table></figure>
<p>Unpermitted parameters? Oh yeah! Strong Parameters has done its job, saving us from parameters we don‚Äôt want. But in this case, we <em>do</em> want that parameter. Open up your <code>app/helpers/articles_helper.rb</code> and fix the <code>article_params</code> method:</p>
<figure class="highlight ruby"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">article_params</span></span></span><br><span class="line">  params.<span class="keyword">require</span>(<span class="symbol">:article</span>).permit(<span class="symbol">:title</span>, <span class="symbol">:body</span>, <span class="symbol">:tag_list</span>)</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<p>If you go back and put ‚Äúruby, technology‚Äù as tags, and click save, you‚Äôll get this new error:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">ActiveRecord::UnknownAttributeError in ArticlesController#create</span><br><span class="line">unknown attribute: tag_list</span><br></pre></td></tr></table></figure>
<p>What is this all about?  Let‚Äôs start by looking at the form data that was posted when we clicked SAVE. This data is in the terminal where you are running the rails server. Look for the line that starts ‚ÄúProcessing ArticlesController#create‚Äù, here‚Äôs what mine looks like:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Processing ArticlesController#create (for 127.0.0.1) [POST]</span><br><span class="line">  Parameters: &#123;&quot;article&quot;=&gt;&#123;&quot;body&quot;=&gt;&quot;Yes, the samples continue!&quot;, &quot;title&quot;=&gt;&quot;My Sample&quot;, &quot;tag_list&quot;=&gt;&quot;ruby, technology&quot;&#125;, &quot;commit&quot;=&gt;&quot;Save&quot;, &quot;authenticity_token&quot;=&gt;&quot;xxi0A3tZtoCUDeoTASi6Xx39wpnHt1QW/6Z1jxCMOm8=&quot;&#125;</span><br></pre></td></tr></table></figure>
<p>The field that‚Äôs interesting there is the <code>&quot;tag_list&quot;=&gt;&quot;technology, ruby&quot;</code>. Those are the tags as I typed them into the form. The error came up in the <code>create</code> method, so let‚Äôs peek at <code>app/controllers/articles_controller.rb</code> in the <code>create</code> method. See the first line that calls <code>Article.new(article_params)</code>?  This is the line that‚Äôs causing the error as you could see in the middle of the stack trace.</p>
<p>Since the <code>create</code> method passes all the parameters from the form into the <code>Article.new</code> method, the tags are sent in as the string <code>&quot;technology, ruby&quot;</code>. The <code>new</code> method will try to set the new Article‚Äôs <code>tag_list</code> equal to <code>&quot;technology, ruby&quot;</code> but that method doesn‚Äôt exist because there is no attribute named <code>tag_list</code>.</p>
<p>There are several ways to solve this problem, but the simplest is to pretend like we have an attribute named <code>tag_list</code>.</p>
<p>We can define the <code>tag_list=</code> method inside <code>article.rb</code> like this: (<strong><em>do not delete your original tag_list method</em></strong>)</p>
<figure class="highlight ruby"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">tag_list=</span><span class="params">(tags_string)</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<p>Just leave it blank for now and try to resubmit your sample article with tags. It goes through!</p>
<h3 id="Not-So-Fast" class="article-heading"><a href="#Not-So-Fast" class="headerlink" title="Not So Fast"></a>Not So Fast<a class="article-anchor" href="#Not-So-Fast" aria-hidden="true"></a></h3><p>Did it really work?  It‚Äôs hard to tell. Let‚Äôs jump into the console and have a look.</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">$ article = Article.last</span><br><span class="line">$ article.tags</span><br></pre></td></tr></table></figure>
<p>I bet the console reported that <code>article</code> had <code>[]</code> tags ‚Äì an empty list. (It also probably said something about an <code>ActiveRecord::Associations::CollectionProxy</code> üòâ ) So we didn‚Äôt generate an error, but we didn‚Äôt create any tags either.</p>
<p>We need to return to the <code>Article#tag_list=</code> method in <code>article.rb</code> and do some more work.</p>
<p>The <code>Article#tag_list=</code> method accepts a parameter, a string like <strong>‚Äútag1, tag2, tag3‚Äù</strong> and we need to associate the article with tags that have those names. The pseudo-code would look like this:</p>
<ul>
<li>Split the <em>tags_string</em> into an array of strings with leading and trailing whitespace removed (so <code>&quot;tag1, tag2, tag3&quot;</code> would become <code>[&quot;tag1&quot;,&quot;tag2&quot;,&quot;tag3&quot;]</code></li>
<li>For each of those strings‚Ä¶<ul>
<li>Ensure each one of these strings are unique</li>
<li>Look for a Tag object with that name. If there isn‚Äôt one, create it.</li>
<li>Add the tag object to a list of tags for the article</li>
</ul>
</li>
<li>Set the article‚Äôs tags to the list of tags that we have found and/or created.</li>
</ul>
<p>The first step is something that Ruby does very easily using the <code>String#split</code> method. Go into your console and try <strong>‚Äútag1, tag2, tag3‚Äù.split</strong>. By default it split on the space character, but that‚Äôs not what we want. You can force split to work on any character by passing it in as a parameter, like this: <code>&quot;tag1, tag2, tag3&quot;.split(&quot;,&quot;)</code>.</p>
<p>Look closely at the output and you‚Äôll see that the second element is <code>&quot; tag2&quot;</code> instead of <code>&quot;tag2&quot;</code> ‚Äì it has a leading space. We don‚Äôt want our tag system to end up with different tags because of some extra (non-meaningful) spaces, so we need to get rid of that. The <code>String#strip</code> method removes leading or trailing whitespace ‚Äì try it with <code>&quot; my sample &quot;.strip</code>. You‚Äôll see that the space in the center is preserved.</p>
<p>So first we split the string, and then trim each and every element and collect those updated items:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&quot;programming, Ruby, rails&quot;.split(&quot;,&quot;).collect&#123;|s| s.strip.downcase&#125;</span><br></pre></td></tr></table></figure>
<p>The <code>String#split(&quot;,&quot;)</code> will create the array with elements that have the extra spaces as before, then the <code>Array#collect</code> will take each element of that array and send it into the following block where the string is named <code>s</code> and the <code>String#strip</code> and <code>String#downcase</code> methods are called on it. The <code>downcase</code> method is to make sure that ‚Äúruby‚Äù and ‚ÄúRuby‚Äù don‚Äôt end up as different tags. This line should give you back <code>[&quot;programming&quot;, &quot;ruby&quot;, &quot;rails&quot;]</code>.</p>
<p>Lastly, we want to make sure that each and every tag in the list is unique. <code>Array#uniq</code> allows us to remove duplicate items from an array.</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&quot;programming, Ruby, rails, rails&quot;.split(&quot;,&quot;).collect&#123;|s| s.strip.downcase&#125;.uniq</span><br></pre></td></tr></table></figure>
<p>Now, back inside our <code>tag_list=</code> method, let‚Äôs add this line:</p>
<figure class="highlight ruby"><table><tr><td class="code"><pre><span class="line">tag_names = tags_string.split(<span class="string">","</span>).collect&#123;<span class="params">|s|</span> s.strip.downcase&#125;.uniq</span><br></pre></td></tr></table></figure>
<p>So looking at our pseudo-code, the next step is to go through each of those <code>tag_names</code> and find or create a tag with that name. Rails has a built in method to do just that, like this:</p>
<figure class="highlight ruby"><table><tr><td class="code"><pre><span class="line">tag = Tag.find_or_create_by(<span class="symbol">name:</span> tag_name)</span><br></pre></td></tr></table></figure>
<p>And finally we need to collect up these new or found new tags and then assign them to our article.</p>
<figure class="highlight ruby"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">tag_list=</span><span class="params">(tags_string)</span></span></span><br><span class="line">  tag_names = tags_string.split(<span class="string">","</span>).collect&#123;<span class="params">|s|</span> s.strip.downcase&#125;.uniq</span><br><span class="line">  new_or_found_tags = tag_names.collect &#123; <span class="params">|name|</span> Tag.find_or_create_by(<span class="symbol">name:</span> name) &#125;</span><br><span class="line">  <span class="keyword">self</span>.tags = new_or_found_tags</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<h3 id="Testing-in-the-Console" class="article-heading"><a href="#Testing-in-the-Console" class="headerlink" title="Testing in the Console"></a>Testing in the Console<a class="article-anchor" href="#Testing-in-the-Console" aria-hidden="true"></a></h3><p>Go back to your console and try these commands:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">reload!</span><br><span class="line">article = Article.create title: &quot;A Sample Article for Tagging!&quot;, body: &quot;Great article goes here&quot;, tag_list: &quot;ruby, technology&quot;</span><br><span class="line">article.tags</span><br></pre></td></tr></table></figure>
<p>You should get back a list of the two tags. If you‚Äôd like to check the other side of the Article-Tagging-Tag relationship, try this:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">tag = article.tags.first</span><br><span class="line">tag.articles</span><br></pre></td></tr></table></figure>
<p>And you‚Äôll see that this Tag is associated with just one Article.</p>
<h3 id="Adding-Tags-to-our-Display" class="article-heading"><a href="#Adding-Tags-to-our-Display" class="headerlink" title="Adding Tags to our Display"></a>Adding Tags to our Display<a class="article-anchor" href="#Adding-Tags-to-our-Display" aria-hidden="true"></a></h3><p>According to our work in the console, articles can now have tags, but we haven‚Äôt done anything to display them in the article pages.</p>
<p>Let‚Äôs start with <code>app/views/articles/show.html.erb</code>. Right below the line that displays the <code>&lt;h1&gt;&lt;%= @article.title %&gt;&lt;/h1&gt;</code>, add these lines:</p>
<figure class="highlight erb"><table><tr><td class="code"><pre><span class="line">&lt;p&gt;</span><br><span class="line">  Tags:</span><br><span class="line">  &lt;%<span class="ruby"> @article.tags.each <span class="keyword">do</span> <span class="params">|tag|</span> </span>%&gt;</span><br><span class="line">    &lt;%=<span class="ruby"> link_to tag.name, tag_path(tag) </span>%&gt;</span><br><span class="line">  &lt;%<span class="ruby"> <span class="keyword">end</span> </span>%&gt;</span><br><span class="line">&lt;/p&gt;</span><br></pre></td></tr></table></figure>
<p>Refresh your view and‚Ä¶BOOM:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">NoMethodError in Articles#show</span><br><span class="line">Showing C:/laragon/www/blog/app/views/articles/show.html.erb where line #5 raised:</span><br><span class="line"></span><br><span class="line">undefined method `tag_path&apos; for #&lt;#&lt;Class:0x0000000ee55930&gt;:0x000000103299d8&gt;</span><br></pre></td></tr></table></figure>
<p>The <code>link_to</code> helper is trying to use <code>tag_path</code> from the router, but the router doesn‚Äôt know anything about our Tag object. We created a model, but we never created a controller or route. There‚Äôs nothing to link to ‚Äì so let‚Äôs generate that controller from your terminal:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">rails generate controller tags</span><br></pre></td></tr></table></figure>
<p>Then we need to add tags as a resource to our <code>config/routes.rb</code>, it should look like this:</p>
<figure class="highlight ruby"><table><tr><td class="code"><pre><span class="line">Rails.Application.routes.draw <span class="keyword">do</span></span><br><span class="line"></span><br><span class="line">  root <span class="symbol">to:</span> <span class="string">'articles#index'</span></span><br><span class="line">  resources <span class="symbol">:articles</span> <span class="keyword">do</span></span><br><span class="line">    resources <span class="symbol">:comments</span></span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line">  resources <span class="symbol">:tags</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<p>Refresh your article page and you should see tags, with links, associated with this article.</p>
<h3 id="Listing-Articles-by-Tag" class="article-heading"><a href="#Listing-Articles-by-Tag" class="headerlink" title="Listing Articles by Tag"></a>Listing Articles by Tag<a class="article-anchor" href="#Listing-Articles-by-Tag" aria-hidden="true"></a></h3><p>The links for our tags are showing up, but if you click on them you‚Äôll see our old friend ‚ÄúThe action ‚Äòshow‚Äô could not be found‚Ä¶‚Äù error.</p>
<p>Open <code>app/controllers/tags_controller.rb</code> and define a show action:</p>
<figure class="highlight ruby"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">show</span></span></span><br><span class="line">  @tag = Tag.find(params[<span class="symbol">:id</span>])</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<p>Then create the show template <code>app/views/tags/show.html.erb</code>:</p>
<figure class="highlight erb"><table><tr><td class="code"><pre><span class="line">&lt;h1&gt;Articles Tagged with &lt;%=<span class="ruby"> @tag.name </span>%&gt;&lt;/h1&gt;</span><br><span class="line"></span><br><span class="line">&lt;ul&gt;</span><br><span class="line">  &lt;%<span class="ruby"> @tag.articles.each <span class="keyword">do</span> <span class="params">|article|</span> </span>%&gt;</span><br><span class="line">    &lt;li&gt;&lt;%=<span class="ruby"> link_to article.title, article_path(article) </span>%&gt;&lt;/li&gt;</span><br><span class="line">  &lt;%<span class="ruby"> <span class="keyword">end</span> </span>%&gt;</span><br><span class="line">&lt;/ul&gt;</span><br></pre></td></tr></table></figure>
<p>Refresh your view and you should see a list of articles with that tag. Keep in mind that there might be some abnormalities from articles we tagged before doing our fixes to the <code>tag_list=</code> method. For any article with issues, try going to its <code>edit</code> screen, saving it, and things should be fixed up. If you wanted to clear out all taggings you could do <code>Tagging.destroy_all</code> from your console.</p>
<h3 id="Listing-All-Tags" class="article-heading"><a href="#Listing-All-Tags" class="headerlink" title="Listing All Tags"></a>Listing All Tags<a class="article-anchor" href="#Listing-All-Tags" aria-hidden="true"></a></h3><p>We‚Äôve built the <code>show</code> action, but the reader should also be able to browse the tags available at <a href="javascript:;" target="_blank" rel="external">http://localhost:3000/tags</a>. I think you can do this on your own. Create an <code>index</code> action in your <code>tags_controller.rb</code> and an <code>index.html.erb</code> in the corresponding views folder. Look at your <code>articles_controller.rb</code> and Article <code>index.html.erb</code> if you need some clues.</p>
<p>Now that we can see all of our tags, we also want the capability to delete them. I think you can do this one on your own too. Create a <code>destroy</code> action in your <code>tags_controller.rb</code> and edit the <code>index.html.erb</code> file you just created. Look at your <code>articles_controller.rb</code> and Article <code>show.html.erb</code> if you need some clues.</p>
<p>With that, a long ‚ÄúTagging‚Äù tutorial is complete!</p>
<h4 id="Saving-to-GitHub" class="article-heading"><a href="#Saving-to-GitHub" class="headerlink" title="Saving to GitHub."></a>Saving to GitHub.<a class="article-anchor" href="#Saving-to-GitHub" aria-hidden="true"></a></h4><p>Woah! The tagging feature is now complete. Good on you. You‚Äôre going to want to push this to the repo.</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git add .</span><br><span class="line">git commit -m &quot;Tagging feature completed&quot;</span><br><span class="line">git push</span><br></pre></td></tr></table></figure>

              </div>
              <footer class="article-footer">
                <time class="article-footer-updated" datetime="2019-03-01T09:46:09.444Z" itemprop="dateModified">Last updated: 2019-03-01</time>
                <a href="adding_comments.html" class="article-footer-prev" title="Adding Comments"><i class="fa fa-chevron-left"></i><span>Prev</span></a><a href="a_few_gems.html" class="article-footer-next" title="A Few Gems"><span>Next</span><i class="fa fa-chevron-right"></i></a>
              </footer>
              
            </div>
          </div>
          <aside id="article-toc" role="navigation">
            <div id="article-toc-inner">
              <strong class="sidebar-title">Contents</strong>
              <ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#Understanding-the-Relationship"><span class="toc-text">Understanding the Relationship</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Making-Models"><span class="toc-text">Making Models</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Expressing-Relationships"><span class="toc-text">Expressing Relationships</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#An-Interface-for-Tagging-Articles"><span class="toc-text">An Interface for Tagging Articles</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Not-So-Fast"><span class="toc-text">Not So Fast</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Testing-in-the-Console"><span class="toc-text">Testing in the Console</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Adding-Tags-to-our-Display"><span class="toc-text">Adding Tags to our Display</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Listing-Articles-by-Tag"><span class="toc-text">Listing Articles by Tag</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Listing-All-Tags"><span class="toc-text">Listing All Tags</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Saving-to-GitHub"><span class="toc-text">Saving to GitHub.</span></a></li></ol></li></ol>
              <a href="#" id="article-toc-top">Back to Top</a>
            </div>
          </aside>
        </div>
      </article>
      <aside id="sidebar" role="navigation">
  <div class="inner"><strong class="sidebar-title">Build a Blog with Ruby on Rails</strong><a href="environment_setup.html" class="sidebar-link">Environment Setup</a><a href="up_and_running.html" class="sidebar-link">Up and Running</a><a href="form_based_workflow.html" class="sidebar-link">Form-based Workflow</a><a href="adding_comments.html" class="sidebar-link">Adding Comments</a><a href="" class="sidebar-link current">Tagging</a><a href="a_few_gems.html" class="sidebar-link">A Few Gems</a><a href="authentication.html" class="sidebar-link">Authentication</a><a href="extras.html" class="sidebar-link">Extras</a></div>
</aside>
    </div>
  </div>
</div>

    <footer id="footer" class="wrapper">
  <div class="inner">
    <div id="footer-copyright">
      Copyright &copy; 2020 - <a href="javascript:;" target="_blank">leokhoa</a><br>
    </div>
    <div id="footer-links">
      <a href="javascript:;" class="footer-link" target="_blank"><i class="fa fa-twitter"></i></a>
      <a href="javascript:;" class="footer-link" target="_blank"><i class="fa fa-github-alt"></i></a>
    </div>
  </div>
</footer>

  </div>
  <div id="mobile-nav-dimmer"></div>
  <nav id="mobile-nav">
  <div id="mobile-nav-inner">
    <ul id="mobile-nav-list">
      <a href="index1.html" class="mobile-nav-link">Docs</a>
      <li class="mobile-nav-item">
        <a href="javascript:;" class="mobile-nav-link" rel="external" target="_blank">GitHub</a>
      </li>
    </ul>
    
      <strong class="mobile-nav-title">Build a Blog with Ruby on Rails</strong><a href="environment_setup.html" class="mobile-nav-link">Environment Setup</a><a href="up_and_running.html" class="mobile-nav-link">Up and Running</a><a href="form_based_workflow.html" class="mobile-nav-link">Form-based Workflow</a><a href="adding_comments.html" class="mobile-nav-link">Adding Comments</a><a href="" class="mobile-nav-link current">Tagging</a><a href="a_few_gems.html" class="mobile-nav-link">A Few Gems</a><a href="authentication.html" class="mobile-nav-link">Authentication</a><a href="extras.html" class="mobile-nav-link">Extras</a>
    
  </div>
  <div id="mobile-lang-select-wrap">
    <span id="mobile-lang-select-label"><i class="fa fa-globe"></i><span>English</span></span>
    <select id="mobile-lang-select" data-canonical="">
      
        <option value="en" selected="">English</option>
      
    </select>
  </div>
</nav>
  <!-- Scripts -->
<!-- build:js build/js/main.js -->

<script src="static/js/lang_select.js"></script>


<script src="static/js/scrollingelement.js"></script>


<script src="static/js/toc.js"></script>


<script src="static/js/mobile_nav.js"></script>

<!-- endbuild -->
<script src="static/js/retina.min.js" async=""></script>

<!-- Algolia -->


<!-- Particles -->

<script src="static/js/particles.js"></script>


<script type="text/javascript">
particlesJS("particles-js", {
  "particles": {
    "number": {
      "value": 60,
      "density": {
        "enable": true,
        "value_area": 800
      }
    },
    "color": {
      "value": "#ffffff"
    },
    "shape": {
      "type": "circle",
      "stroke": {
        "width": 0,
        "color": "#000000"
      },
      "polygon": {
        "nb_sides": 5
      },
      "image": {
        "src": "img/github.svg",
        "width": 100,
        "height": 100
      }
    },
    "opacity": {
      "value": 0.1,
      "random": false,
      "anim": {
        "enable": false,
        "speed": 1,
        "opacity_min": 0.1,
        "sync": false
      }
    },
    "size": {
      "value": 6,
      "random": false,
      "anim": {
        "enable": false,
        "speed": 40,
        "size_min": 0.1,
        "sync": false
      }
    },
    "line_linked": {
      "enable": true,
      "distance": 150,
      "color": "#ffffff",
      "opacity": 0.1,
      "width": 2
    },
    "move": {
      "enable": true,
      "speed": 1.5,
      "direction": "top",
      "random": false,
      "straight": false,
      "out_mode": "out",
      "bounce": false,
      "attract": {
        "enable": false,
        "rotateX": 600,
        "rotateY": 1200
      }
    }
  },
  "interactivity": {
    "detect_on": "canvas",
    "events": {
      "onhover": {
        "enable": false,
        "mode": "repulse"
      },
      "onclick": {
        "enable": false,
        "mode": "push"
      },
      "resize": true
    },
    "modes": {
      "grab": {
        "distance": 400,
        "line_linked": {
          "opacity": 1
        }
      },
      "bubble": {
        "distance": 400,
        "size": 40,
        "duration": 2,
        "opacity": 8,
        "speed": 3
      },
      "repulse": {
        "distance": 200,
        "duration": 0.4
      },
      "push": {
        "particles_nb": 4
      },
      "remove": {
        "particles_nb": 2
      }
    }
  },
  "retina_detect": true
});
</script>

<!-- fastclick -->
<script src="static/js/fastclick.min.js"></script>
<script>
document.addEventListener('DOMContentLoaded', function() {
  FastClick.attach(document.body)
}, false)
</script>



</body>
</html>